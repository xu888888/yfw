"use strict";function getStorage(){return JSON.parse(localStorage.getItem("list")||"[]")}function setStorage(t){localStorage.setItem("list",JSON.stringify(t))}function addCartEvent(){$(".addCart").click(function(){var t={id:$("#shop_id").html(),img:$("#imgSmall").attr("src"),name:$("#shop_name").html(),price:$("#shop_prices").html(),num:Math.abs($("#shop_num").val()),spec:$("#spec").html(),vender:$("#vender ").html(),shop:"上海浦东新区雪莲药房"};$.ajax({url:"../php/addwq.php",dataType:"json",data:t,success:function(t){t.code?($(".cart_to").css({display:"block"}),$(".cart_to_button ").css({display:"block"}),$(".quxiao").click(function(){$(".cart_to").css({display:"none"}),$(".cart_to_button ").css({display:"none"})}),$(".cha").click(function(){location.href="./cart.html"}),$(".liu").click(function(){$(".cart_to").css({display:"none"}),$(".cart_to_button ").css({display:"none"})})):alert("请先登录！")}}),addProduct(t),$(".cart_to").css({display:"block"}),$(".cart_to_button ").css({display:"block"}),$(".quxiao").click(function(){$(".cart_to").css({display:"none"}),$(".cart_to_button ").css({display:"none"})}),$(".cha").click(function(){location.href="./cart.html"}),$(".liu").click(function(){$(".cart_to").css({display:"none"}),$(".cart_to_button ").css({display:"none"})})})}function addProduct(t){for(var n=getStorage(),i=0;i<n.length;i++)if(n[i].id==t.id)return n[i].num=n[i].num+t.num,void setStorage(n);n.push(t),setStorage(n)}if($(".magnifier_small").hover(function(){$(".magnifier_pup").css({display:"block"}),$(this).next().css({display:"block"});var l=$(".magnifier").offset().left,a=$(".magnifier").offset().top;$("html").mousemove(function(t){var n=t.pageX,i=t.pageY;(n=n-l-$(".magnifier_pup").innerWidth()/2)<0&&(n=0),(i=i-a-$(".magnifier_pup").innerHeight()/2)<0&&(i=0),n>$(".magnifier_small").innerWidth()-$(".magnifier_pup").innerWidth()&&(n=$(".magnifier_small").innerWidth()-$(".magnifier_pup").innerWidth()),i>$(".magnifier_small").innerHeight()-$(".magnifier_pup").innerHeight()&&(i=$(".magnifier_small").innerHeight()-$(".magnifier_pup").innerHeight()),$(".magnifier_pup").css({left:n,top:i});var o=-n/$(".magnifier_small").innerWidth()*800,e=-i/$(".magnifier_small").innerHeight()*800;$(".magnifier_big").css({backgroundPositionX:o+"px",backgroundPositionY:e+"px"})})},function(){$(".magnifier_pup").css({display:"none"}),$(this).next().css({display:"none"})}),$("#jia").click(function(){$("#shop_num").val(Number($("#shop_num").val())+1)}),$("#jian").click(function(){$("#shop_num").val(Number($("#shop_num").val())-1),$("#shop_num").val()<=1&&$("#shop_num").val(1)}),$("#shop_num").on("input",function(t){t.target.value=t.target.value.replace(/\-/g,"")}),localStorage.getItem("names")?($(".login-button").html(localStorage.getItem("names")),$(".reset-button").html("[退出]"),$(".login").html("您好"+$(".login").html()),$(".reset-button").click(function(){localStorage.setItem("names",""),location.reload()})):($(".login-button").html("登录"),$(".reset-button").html("注册"),$(".login").html(" "+$(".login").html()),$(".reset-button").click(function(){location.href="./enroll.html",$(this).target="_blank"}),$(".login-button").click(function(){location.href="./login.html",$(this).target="_blank"})),null!=localStorage.getItem("names")){$(".login-button").html(localStorage.getItem("names")),$(".reset-button").html("[退出]"),$(".login").html(""+$(".login").html()),$(".reset-button").click(function(){localStorage.removeItem("names"),location.reload()});var num=JSON.parse(localStorage.getItem("list"));null==num?$(".car_num").text("0"):$(".car_num").text(num.length),$(".cart_go").click(function(){location.href="../pages/cart.html"}),addCartEvent()}else $(".addCart").click(function(){alert("请先登录！"),location.href="../pages/login.html"}),$(".login-button").html("登录"),$(".reset-button").html("注册"),$(".login").html(" "+$(".login").html()),$(".reset-button").click(function(){location.href="./enroll.html",$(this).target="_blank"}),$(".login-button").click(function(){location.href="./login.html",$(this).target="_blank"}),$(".cart_go").click(function(){location.href="../pages/login.html"});